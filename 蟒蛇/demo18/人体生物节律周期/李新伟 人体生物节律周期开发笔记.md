### 人体生物节律周期开发笔记

#### **一．** **需求分析**

三条线：智力，心情，体力

智力周期：33天

情绪周期：28天

体力周期：23天

输入要求：出生日期以及测试日期

输出要求：测试日期前后十天三条线的波形图



#### **二．** **思路**

利用matplotlib.pyplot与numpy画图

利用datetime来计算时间

首先需要定义一个函数ceshi，用来完成实现波形图的目的，接着再定义一个函数ceshi_1,其中调用测试，用来实现防呆设置，最后用一个while循环,其中调用ceshi_1,实现反复画图的目的

```python
import matplotlib.pyplot as plt
import numpy as np
import datetime as dt
def ceshi():
    pass
def ceshi_1():
    pass
while(1):
    ceshi_1()
```



##### 1.ceshi()

1. 输入两个日期
2. 将两个日期格式化
3. 算出两个日期之间差值
4. 规定三条线自变量范围
5. 规定三个y与x的函数关系
6. 设置x轴，y轴标签
7. 改变x轴，y轴数字为自己想要出现的值或字符
8. 对应每个x与y的关系
9. 显现图标
10. 展现波形图



##### 2.ceshi_1

利用try实现防呆



#### 三.实现

##### 1.输入两个日期

```python
a=input("请输入你的出生年月日(xxxx xx xx):\n").split()
b=input("请输入你要测试年月日(xxxx xx xx):\n").split()
```

以xxxx xx xx的形式输入，使用split会把年月日以空格为分割把三个数变成列表中的三个数

这样便于之后把年月日格式化



##### 2.将两个日期格式化

将测试日期与出生日期的格式化时间分别表示出来

```python
last=dt.datetime(int(a[0]),int(a[1]),int(a[2]))
ce=dt.datetime(int(b[0]),int(b[1]),int(b[2]))
```

先用int将列表里的字符串装化为int类型

再将其格式化

下面的代码可以了解datetime如何将时间格式化

```python
import datetime as dt
lst=dt.datetime(2002,12,17)
print(lst)

#结果:2002-12-17 00:00:00
```



##### 3.算出两个日期之间的差值

```python
day=(ce-last).days
```

这样就知道了两天之间差多少天

下面也演示一下其作用

```python
lst=dt.datetime(2002,12,17)
ce=dt.datetime(2022,3,3)
print(lst)
print(ce)
day=(ce-lst).days
print(ce-lst)
print(day)

"""
2002-12-17 00:00:00
2022-03-03 00:00:00
7016 days, 0:00:00
7016
"""
```



##### 4.规定三条线的自变量范围

分别把三条线的自变量取名为x_itl , x_mood , x_stg

```python
x_itl=np.arange(day-10,day+10,0.01)
x_mood=np.arange(day-10,day+10,0.01)
x_stg=np.arange(day-10,day+10,0.01)
```

因为要画出测试日期前后10天的波形图，所以自变量范围要取前后10天，第三个参数取0.01，让波形图更丝滑

注意这个位置是去不到day+10的，但是由于步长是0.01，就可以取到day+9.99，如果步长为1的话，后面就要改成day+11了



##### 5.规定y与x的函数关系

```python
y_itl=np.sin(2*np.pi*x_itl/33)
y_mood=np.sin(2*np.pi*x_mood/28)
y_stg=np.sin(2*np.pi*x_stg/23)
"""
y_itl=np.sin(2*np.pi*(x_itl%33)/33)
y_mood=np.sin(2*np.pi*(x_mood%28)/28)
y_stg=np.sin(2*np.pi*(x_stg%23)/23)
"""
```

分别将y_itl，y_mood，y_stg的定为周期为33，28，23的正弦函数

这个位置上面三行与下面三行是等价的，一般来说下面比较标准，但是因为这个位置取余只是无用功，因为就算不取余，能过整除的部分会与2Π相乘，结果是得到2Π的倍数，而sin里面加一个2Π与减一个2Π是不影响结果的，所以可以用上面的

##### 6.设置x轴，y轴标签

```python
plt.xlabel("date")
plt.ylabel("status")
```

将x轴上的标签设置为date

将y轴上的标签设置为status



##### 7.改变x轴，y轴数字为自己想要出现的值或字符

xticks的作用为把x轴上的值打记号，yticks的作用是把y轴上的值打记号

其中放入两个中括号，两个中括号中的值一一对应，后面的值为前面的值的替换值

```python
plt.xticks([day,day-5,day-10,day+5,day+10],[b[1]+"."+b[2],"last five","last ten","after five","after ten"])
plt.yticks([0,0.5,1,-0.5,-1],["$normal$","$good$","$very\ good$","$bad$","$very\ bad$"])
```

x坐标：

把day (从出生日期到测试当天间隔的天数) 的值设为b[1]+“.”+b[2]  (测试当天的日期) ，把day-5 (测试日期第前五天) 设为last five ，把day-10(测试日期第前十天) 设为last ten ，把day+5 (测试日期第后五天) 设为after five ，把day+10 (测试日期第后五天) 设为after ten

|  时间  |    设定值     |
| :----: | :-----------: |
|  day   | b[1]+“.”+b[2] |
| day-5  |   last five   |
| day-10 |   last ten    |
| day+5  |  after five   |
| day+10 |   after ten   |

y坐标：

把0设为normal，把-0.5设为bad，把-1设为very bad，把0.5设为good，把1设为very good

| y轴值 |  设定值   |
| :---: | :-------: |
|   0   |  normal   |
| -0.5  |    bad    |
|  -1   | very bad  |
|  0.5  |   good    |
|   1   | very good |

其中normal 等单词外面加了$$，这是为了把字体弄好看点，但是这样就会导致very good中的空格被去掉，需要使用“\”来转义空格，让它出现



##### 8.对应每个x与y的关系

```python
plt.plot(x_itl,y_itl,label="intelligence")
plt.plot(x_mood,y_mood,label="mood")
plt.plot(x_stg,y_stg,label="strength")
```

这就把x_itl与y_itl，x_mood与y_mood，x_stg与y_stg联系起来了

后面的label是给每条线贴一个标签，这样就可以在波形图中轻松的了解哪条线是哪条线



##### 9.显现图标

```python
plt.legend()
```

在8中，给每条线一个标签后，需要使用legend把图标显现出来

![image-20220303184548390](https://gitee.com/buguai_lxw/key/raw/master/202203031845460.png)

效果如上图

另外，三条线会自动显现不同的颜色，也可以自己用color来改变颜色



##### 10.展现图表

用show把图标展现出来

```python
plt.show()
```



##### 11.防呆

为了防止输入人不按照规定输入，需要使用防呆设置，这时又需要定义一个函数ceshi_1

```python
def ceshi_1():
    try:
        ceshi()
    except:
        print("输入错误，请重新输入")
        ceshi_1()
```

函数中使用try   except

try中放入ceshi()函数，如果报错就进入except中的程序

这时会提醒输入错误了，然后再递归，调用ceshi_1()函数，之后又进入ceshi()中，直到输入没有出错



##### 12.循环

最后需要使用一个while(1)死循环

其中放入ceshi_1()函数，这样可以实现打印了一张波形图之后可以再进行第二次，第三次打印，可以不断重复打印下去，直到关闭程序

```python
while(1):
    ceshi_1()
```



#### 四.打包

要将py文件打包成exe文件，需要以下两步：

##### 1.下载pyinstaller库

首先需要打开cmd，接着再输入pip install pyinstaller，回车

这样就完成了库的下载

![](https://gitee.com/buguai_lxw/key/raw/master/202203031911064.png)

我这是之前以及下载好了的

##### 2.利用pyinstaller库打包文件

还是在cmd中，输入pyinstaller -F +py文件所在路径+py文件文件名

![image-20220303191610496](https://gitee.com/buguai_lxw/key/raw/master/202203031916541.png)

回车之后就会开始进行打包

![image-20220303191803941](https://gitee.com/buguai_lxw/key/raw/master/202203031918006.png)

这样便是成功了

接着会出现一个dist文件，里面会有一个刚刚你打包的文件的exe文件

![image-20220303212751352](https://gitee.com/buguai_lxw/key/raw/master/202203032127413.png)

打开便是这样的界面

![image-20220303212852575](https://gitee.com/buguai_lxw/key/raw/master/202203032128628.png)

输入之后就会出现这样的画面

![image-20220303212932475](https://gitee.com/buguai_lxw/key/raw/master/202203032129548.png)

这便是成功了

![image-20220303213018710](https://gitee.com/buguai_lxw/key/raw/master/202203032130773.png)

与网上搜到的结果一致，程序设计成功
